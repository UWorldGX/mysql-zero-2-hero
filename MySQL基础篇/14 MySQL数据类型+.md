# 14 MySQL数据类型+

*****

## 14.1 MySQL数据类型再梳理

<img src="https://i.imgtg.com/2023/07/05/OxAofr.png" alt="OxAofr.png" border="0">

* 常见数据类型的属性如下:

| 属性 | 作用 |
| --- | --- |
| `NULL/NOT NULL` | 字段是否包含`NULL` |
| `DEFAULT` | 默认值 |
| `PRIMARY KEY` | 主键 |
| `AUTO_INCREMENT` | 自动递增，适用于整数类型 |
| `UNSIGNED` | 无符号 |
| `CHARACTER SET name` | 指定的字符集 |

> 关于`CHARACTER SET name`
> * 创建数据库时可以指定字符集。
> * 创建表时候可以指定表的字符集。
> * 创建表时候，单独一个字段也可以指定它的字符集。
> * 若未指定字符集，则按照字段 -> 表 -> 数据库 -> my.ini中的默认字符集进行上溯，就近取值。

## 14.2 整数类型

### 14.2.1 介绍

| 类型名 | 字节数 | 最大值 |
| --- | --- | --- |
| `TINYINT` | 1 | ±128, 255 |
| `SMALLINT` | 2 | ±32767， 65535 |
| `MEDIUMINT` | 3 | ±8388607，16777215 |
| `INT` | 4 | ±2147483647，4294967295 |
| `BIGINT` | 8 | |

> MySQL 5.7中，对表进行DESC时，整数类型字段的类型名后会加括号，括号内指明这个类型显示数据最大的宽度，即默认的宽度(M)。注意*正负号也算宽度的一部分*。
> 注意`BIGINT`类型无符号。

### 14.2.2 可选属性

整数类型的可选属性如下:

* `M`:表示显示宽度，取值范围为(0, 255)。该项功能需要配合`ZEROFILL`使用。当某条记录的该字段的值小于这个宽度时，不足部分会被0填充。
    * 但如果插入数据的位数高于这个值，**并不会导致插入失败或者数据被截断**。故在MySQL 8.0.17开始，不推荐使用这个属性。
    * 可以这样指定整数类型字段的显示宽度:
    ```sql
    CREATE TABLE table_1
    (
        x INT(5) ZEROFILL
    );
    ```

* `UNSIGNED`:指明无符号。

* `ZEROFILL`:不足`M`位数的部分用0填充。必须与`M()`和`UNSIGNED`配合使用才有效果。若整数超过`M`则数据照样存储，且无需再用0填充。
    * 使用`ZEROFILL`时，会自动加上`UNSIGNED`。

## 14.3 浮点类型

共包含`FLOAT/DOUBLE/REAL`三种。

* 其中，若设置过SQL模式中的`REAL_AS_DOUBLE`，则REAL默认就是DOUBLE。

```sql
SET sql_mode = REAL_AS_FLOAT； -- 可以这样改成REAL与FLOAT等价
```

> 注意两种浮点类型的无符号范围只相当于*有符号部分的正数部分*。原因在于，MySQL中浮点类型值的存储由`符号(S)`，`尾数(M)`与`阶码(E)`组成。即**无论如何都会储存符号部分**。
> 因此浮点类型**不必指定`UNSIGNED`**。

### 14.3.1 数据精度说明

* MySQL允许使用非标准语法:`FLOAT/DOUBLE(m, d)`，m是精度（整数位+小数位），d是标度（小数位）。涉及到数据库迁移时不要这么写。
* 若不指定精度和标度，`FLOAT/DOUBLE`将按实际精度（由计算机决定）显示。
* `UNSIGNED`不会改变精度和标度。

* 不论是否显式设置了精度，处理方案如下：
    * 若整数部分溢出，MySQL将报错；
    * 若小数部分溢出，则如下处理:
        * 四舍五入后整数部分未溢出，则仅警告并成功插入、按照四舍五入截断小数部分；
        * 四舍五入后整数部分溢出，报错。

* 在MySQL 8.0.17开始，不推荐使用精度和标度。

### 14.3.2 精度误差说明

* 如同其他语言，MySQL中的浮点类型存在误差。且FLOAT > DOUBLE。避免直接比较两个浮点类型的值。

## 14.4 定点类型

即`DECIMAL`（也叫`DEC/NUMERIC`）类型。MySQL使用`DECIMAL(m, d)`定义它。m、d的含义同上。

* DECIMAL的最大存储空间与`DOUBLE`一样，但是实际存储空间为`m+2`个字节。在一些精度要求不高的情况下，DOUBLE的取值范围更大。
* 定点数在内部以字符串形式存储，保证了精确性。
* 默认的DECIMAL为`DECIMAL(10,0)`。数据精度溢出时则视情况进行四舍五入截断/报错，处理逻辑同上。

## 14.5 位类型

即`BIT`类型，可以存储二进制数，与其他类型类似，定义为`BIT(M)`，M为二进制的位数，默认为1，最大为64。占用的空间约为`(M + 7) / 8`个字节。

## 14.6 日期和时间类型